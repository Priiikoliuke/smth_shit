# Почему приложения зависят от операционной системы
`(Why Applications Are Operating-System Specific)`

## 1. Введение
Копирование исполняемого файла между разными операционными системами (например, с Windows на macOS) приводит к тому, что программа не запускается, даже если архитектура процессора совпадает.  
Причина не только в различии **CPU архитектур (x86, ARM)**, но и в особенностях **операционных систем**.



## 2. Архитектура и ОС
Даже если две ОС используют один и тот же процессор, приложения, скомпилированные под одну систему, не смогут работать на другой.  
Программы зависят не только от процессора, но и от **интерфейсов операционной системы**.



## 3. Системные вызовы (System Calls)
- ОС управляет аппаратными ресурсами и работает в **Kernel Mode (режим ядра)**.  
- Пользовательские программы работают в **User Mode (пользовательский режим)** и не имеют прямого доступа к оборудованию.  
- Чтобы выполнить операции вроде чтения файла или работы с сетью, программы используют **System Calls (системные вызовы)** — функции, которые обращаются к ядру ОС для выполнения нужных задач.  

Каждая ОС имеет собственный набор и реализацию системных вызовов → программы становятся **специфичными для конкретной ОС**.


## 4. Примеры различий
- **Windows** использует системный вызов `CreateProcess()` для создания нового процесса.  
- **Unix/Linux** — комбинацию `fork()` и `exec()`.  
Различия в подходах делают программы несовместимыми даже при одинаковом процессоре.


## 5. Аппаратный уровень взаимодействия
При системных вызовах процессор:
- переходит в **Kernel Mode**,  
- определяет тип вызова по уникальному номеру (syscall number),  
- использует таблицу системных вызовов (**Syscall Table**) для выполнения нужной функции.

Проблема: у разных ОС — разные таблицы, номера вызовов, регистры и способы передачи параметров.  
Даже малейшие отличия приводят к сбоям и ошибкам при попытке запустить программу другой системы.


## 6. ABI (Application Binary Interface)
**ABI** — набор правил, определяющих, как части бинарного кода взаимодействуют:
- какие регистры используются,  
- как передаются параметры,  
- как структурированы файлы и данные.  

Даже при одинаковом CPU разные ОС имеют разные ABI, что делает их несовместимыми на уровне машинного кода.


## 7. Формат исполняемых файлов
Каждая ОС использует свой формат:
- **Windows** — PE (Portable Executable)  
- **Linux** — ELF (Executable and Linkable Format)

Формат определяет, как программа загружается в память, где хранятся данные и как ОС управляет исполнением.  
Различия в формате — ещё одна причина несовместимости.


## 8. Среды выполнения (Runtime Environments)
Языки вроде Java, Python и др. используют **виртуальные машины (Virtual Machines)** или **интерпретаторы**, что делает программы кроссплатформенными.  
Однако отсутствие нужного рантайма делает запуск невозможным.


## 9. Итог
Программы зависят не только от процессора, но и от множества факторов:
- набора **System Calls**,  
- особенностей **ABI**,  
- формата **исполняемых файлов**,  
- наличия **runtime-среды**.  

Эти различия делают приложения **операционно-зависимыми (OS-specific)**, даже при одинаковом оборудовании.
